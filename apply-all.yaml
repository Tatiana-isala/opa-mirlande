#!/bin/bash
echo "### Application des politiques ###"

# Templates
echo "üìù Application des ConstraintTemplates..."
kubectl apply -f templates/

# Constraints
echo "üîí Application des Constraints..."
kubectl apply -f constraints/

# Tests
echo "üß™ Test des mauvaises configurations (devraient √©chouer):"
for file in test-cases/bad/*.yaml; do
  echo "‚û§ Test $(basename $file):"
  kubectl apply -f "$file" 2>&1 | grep -E "denied|error" || echo "‚ö†Ô∏è √âchec : la politique n'a pas bloqu√© cette configuration !"
done


